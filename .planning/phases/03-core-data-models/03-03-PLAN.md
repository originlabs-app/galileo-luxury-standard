---
phase: 03-core-data-models
plan: 03-03
title: EPCIS Alignment & Extensions
wave: 3
depends_on: ["03-01", "03-02"]
estimated_files: 8
---

# Plan 03-03: EPCIS Alignment & Extensions

## Summary

This plan delivers the EPCIS 2.0 alignment documentation, GS1 Digital Link integration patterns, and luxury-specific schema extensions including molecular signature authentication. It bridges the DPP schemas (03-01) and lifecycle event schemas (03-02) with the broader GS1 ecosystem, providing vocabulary mappings and integration guidance. The molecular signature extension enables ultra-luxury provenance verification through DNA tagging, spectral fingerprinting, and isotopic analysis.

## Requirements Covered

- **EVENT-07**: EPCIS 2.0 alignment with CBV 2.0 vocabulary mapping for luxury lifecycle states
- **EVENT-08**: Molecular signature extension schema for DNA tagging, spectral fingerprinting, and terroir authentication

## Artifacts

### Alignment Documentation
- `specifications/schemas/alignment/cbv-mapping.md` - CBV 2.0 vocabulary mapping for luxury lifecycle
- `specifications/schemas/alignment/gs1-integration.md` - GS1 Digital Link integration with did:galileo

### Extension Context
- `specifications/schemas/contexts/molecular.jsonld` - JSON-LD context for molecular authentication vocabulary

### Extension Schemas
- `specifications/schemas/extensions/molecular-signature.schema.json` - Core molecular authentication schema
- `specifications/schemas/extensions/leather-signature.schema.json` - Leather-specific DNA/spectral signatures
- `specifications/schemas/extensions/spectral-fingerprint.schema.json` - NIR/Raman spectroscopy data schema
- `specifications/schemas/extensions/terroir-provenance.schema.json` - Geographic origin authentication (isotopic)
- `specifications/schemas/extensions/artisan-attribution.schema.json` - Craftsperson attribution with privacy controls

## Must-Haves

1. **cbv-mapping.md** maps all luxury lifecycle states to CBV 2.0 bizStep and disposition values
2. **cbv-mapping.md** documents custom Galileo extensions where CBV 2.0 lacks coverage
3. **gs1-integration.md** defines URI construction: `https://id.gs1.org/01/{GTIN14}/21/{Serial}` -> `did:galileo:01:{GTIN14}:21:{Serial}`
4. **gs1-integration.md** specifies resolver behavior for context-aware routing (consumer vs. brand vs. regulator)
5. **molecular.jsonld** defines vocabulary: MolecularAuthentication, LeatherSignature, SpectralSignature, TerroirAuthentication
6. **molecular-signature.schema.json** supports multiple provider types: DNA_TAGGANT, SPECTRAL, ISOTOPIC
7. **All extension schemas** are optional additions to DPP documents (not breaking changes)
8. **artisan-attribution.schema.json** supports pseudonymous artisan DIDs with optional public profile linkage

## Approach

### Task 1: CBV 2.0 Vocabulary Mapping

Create cbv-mapping.md documenting how Galileo uses CBV 2.0:

**bizStep Mapping for Luxury Lifecycle:**

| Galileo Stage | EPCIS Event Type | CBV bizStep | Notes |
|---------------|------------------|-------------|-------|
| Creation | ObjectEvent | commissioning | Product manufacturing complete |
| Commission | ObjectEvent | commissioning | Unique ID assigned, NFC/QR linked |
| First Sale | TransactionEvent | retail_selling | Initial ownership transfer |
| Repair/MRO | TransformationEvent | repairing | Service, reconditioning, parts |
| Resale | TransactionEvent | retail_selling | Secondary market transfer |
| Decommission | ObjectEvent | decommissioning | End of life, recycling |

**Additional bizStep usage:**
- `shipping`: Between locations (brand to boutique)
- `receiving`: Arrival at destination
- `inspecting`: Authentication verification
- `storing`: Warehouse/vault storage

**disposition Mapping:**

| Galileo State | CBV disposition | When Used |
|---------------|-----------------|-----------|
| Active | active | Product in circulation |
| Sold | retail_sold | After ownership transfer |
| In Service | in_progress | During repair/MRO |
| Destroyed | destroyed | End of life recycling |
| Recalled | recalled | Brand recall action |
| Stolen | stolen | Theft reported |

**Custom Galileo Extensions (where CBV insufficient):**
- `galileo:Disp-cpo_certified` - Certified Pre-Owned status
- `galileo:Disp-vault_storage` - High-value storage
- `galileo:Disp-authentication_pending` - Awaiting verification

**Source/Destination Types:**
- `cbv:SDT-owning_party` - Ownership transfers (sale, resale)
- `cbv:SDT-possessing_party` - Custody transfers (service, consignment)
- `cbv:SDT-location` - Physical location changes

### Task 2: GS1 Digital Link Integration

Create gs1-integration.md documenting resolver integration:

**URI Mapping:**
```
GS1 Digital Link:  https://id.gs1.org/01/09506000134352/21/ABC123
did:galileo:       did:galileo:01:09506000134352:21:ABC123
```

**Bi-directional Resolution:**
1. **GS1 -> Galileo**: GS1 resolver redirects to Galileo resolver based on GTIN prefix registration
2. **Galileo -> GS1**: Galileo DID document includes GS1 Digital Link as alsoKnownAs

**Context-Aware Routing:**

| Requester Context | Response Type | Data Access Level |
|-------------------|---------------|-------------------|
| Consumer (default) | Public DPP view | Sustainability, authenticity, care instructions |
| Brand (authenticated) | Full DPP + events | Complete lifecycle history |
| Regulator (verified) | Compliance view | ESPR mandatory fields + audit trail |
| Service Center (authorized) | Service view | Repair history + technical specifications |

**Resolution Protocol:**
1. Parse GS1 Digital Link or did:galileo URI
2. Extract GTIN (AI 01) and serial (AI 21)
3. Determine requester context (Accept header, auth token, query param)
4. Return appropriate JSON-LD document

**Linkage to Phase 2 did:galileo:**
- Reference 02-03-PLAN.md DID document structure
- DID document `alsoKnownAs` includes GS1 Digital Link
- DID document `service` endpoints include resolver URL

### Task 3: Molecular Signature Extension Schemas

**molecular.jsonld (Context):**
```json
{
  "@context": {
    "galileo": "https://vocab.galileo.luxury/",

    "MolecularAuthentication": "galileo:MolecularAuthentication",
    "LeatherSignature": "galileo:LeatherSignature",
    "SpectralSignature": "galileo:SpectralSignature",
    "TerroirAuthentication": "galileo:TerroirAuthentication",

    "signatureType": "galileo:signatureType",
    "provider": "galileo:authProvider",
    "verificationMethod": "galileo:verificationMethod",
    "signatureDate": "galileo:signatureDate",

    "dnaMarkerRef": "galileo:dnaMarkerRef",
    "spectralHash": "galileo:spectralHash",
    "isotopicSignature": "galileo:isotopicSignature"
  }
}
```

**molecular-signature.schema.json:**
- Root type: MolecularAuthentication
- Required: signatureType (enum: DNA_TAGGANT, SPECTRAL, ISOTOPIC, COMBINED)
- Required: provider (DID of authentication provider)
- Required: signatureDate (ISO 8601)
- Optional: leatherProvenance (LeatherSignature reference)
- Optional: spectralFingerprint (SpectralSignature reference)
- Optional: terroirData (TerroirAuthentication reference)

**leather-signature.schema.json:**
- For leather goods provenance via DNA tagging
- Required: tanneryCertified (boolean)
- Required: tanneryId (DID)
- Required: hideOrigin (ISO 3166-1 alpha-3)
- Required: dnaMarkerRef (provider marker ID)
- Required: verificationMethod (enum: PCR_AMPLIFICATION, NEXT_GEN_SEQUENCING)
- Optional: animalSpecies (enum: bovine, ovine, caprine, exotic)
- Optional: tanningProcess (enum: vegetable, chrome, combination)

**spectral-fingerprint.schema.json:**
- For material authentication via spectroscopy
- Required: method (enum: NIR_SPECTROSCOPY, RAMAN_SPECTROSCOPY, FTIR)
- Required: wavelengthRange (string, e.g., "900-2500nm")
- Required: referenceHash (SHA-256 of spectral data)
- Required: captureDate (ISO 8601)
- Optional: instrumentModel (string)
- Optional: calibrationRef (string)

**terroir-provenance.schema.json:**
- For geographic origin authentication via isotopic analysis
- Required: materialType (enum: leather, textile, precious_metal, gemstone)
- Required: geographicOrigin (object: country, region, specificArea)
- Required: isotopicSignature (object: method, measured values)
- isotopicSignature.method: enum [IRMS, SIMS, LA-ICP-MS]
- isotopicSignature values: delta13C, delta15N, delta18O (numeric)

### Task 4: Artisan Attribution Extension

**artisan-attribution.schema.json:**
- For craftsperson attribution with GDPR-compliant privacy
- Required: artisanDID (did:galileo:artisan:xxx format)
- Required: attributionType (enum: sole_maker, lead_artisan, contributor)
- Required: productionDate (ISO 8601)
- Optional: publicProfile (boolean, default false)
- Optional: publicName (string, only if publicProfile=true)
- Optional: specialization (enum: leather_work, watchmaking, jewelry, textile)
- Optional: atelier (facility DID)
- Privacy model:
  - Default: Pseudonymous DID only (satisfies traceability without PII exposure)
  - Opt-in: Artisan can link DID to public profile with name/bio
  - Revocable: Artisan can disconnect public profile while keeping DID attribution

**Integration with DPP:**
- DPP can include galileo:artisanAttribution referencing this schema
- Multiple artisans possible (team attribution)
- Links to creation event ilmd.galileo:artisanId

## Dependencies

### Prior Phase 3 Plans
- **03-01-PLAN**: DPP core schema - extensions must be compatible additions
- **03-01-PLAN**: galileo.jsonld context - molecular.jsonld extends this
- **03-02-PLAN**: Event schemas - vocabulary mapping must align with event schemas

### Prior Phase Outputs
- **Phase 2 (02-03-PLAN)**: did:galileo method - GS1 integration must align with DID document structure
- **Phase 2 (02-01-PLAN)**: GDPR boundaries - artisan attribution must respect PII constraints

### External Standards
- **CBV 2.0**: https://ref.gs1.org/cbv/ - Authoritative vocabulary definitions
- **GS1 Digital Link 1.4.0**: https://ref.gs1.org/standards/digital-link/ - URI syntax
- **ISO 17025**: Laboratory accreditation (for molecular signature providers)
- **ISO/IEC 17065**: Product certification bodies (for CPO programs)

### Molecular Signature Providers (Reference)
- Applied DNA Sciences - DNA tagging for textiles, leather
- Haelixa - DNA markers for cotton, cashmere
- SMX - Spectral fingerprinting
- Oritain - Isotopic origin verification

## Out of Scope

- Implementation of molecular signature verification systems (specification only)
- Provider certification program (governance topic)
- Spectral data storage infrastructure (operational concern)
- Real-time verification API specification (future phase)
- Machine learning models for spectral matching (implementation detail)
- Geographic indication (GI) legal compliance (Phase 8 compliance documentation)
- Cross-border molecular signature recognition (regulatory topic)

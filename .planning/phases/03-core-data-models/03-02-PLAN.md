---
phase: 03-core-data-models
plan: 03-02
title: Lifecycle Event Schemas
wave: 2
depends_on: ["03-01"]
estimated_files: 7
---

# Plan 03-02: Lifecycle Event Schemas

## Summary

This plan delivers the complete set of lifecycle event schemas for tracking luxury product journeys from creation through decommission. All events follow EPCIS 2.0 JSON-LD binding with CBV 2.0 vocabulary, ensuring EU DPP interoperability. The schemas cover six lifecycle stages: creation, commission, first sale, repair/MRO, resale, and decommission. Each event type uses the appropriate EPCIS event class (ObjectEvent, TransactionEvent, TransformationEvent) with Galileo-specific extensions for luxury context.

## Requirements Covered

- **EVENT-01**: Creation event schema capturing initial product manufacturing with ilmd (Instance/Lot Master Data)
- **EVENT-02**: Commission event schema for unique identifier assignment and DPP linkage
- **EVENT-03**: First sale event schema capturing initial retail transaction and warranty activation
- **EVENT-04**: Repair/MRO event schema tracking service history and parts replacement
- **EVENT-05**: Resale event schema for secondary market transactions with CPO status
- **EVENT-06**: Decommission event schema for end-of-life tracking and material recovery

## Artifacts

### Base Schema
- `specifications/schemas/events/event-base.schema.json` - Common EPCIS 2.0 event structure with Galileo extensions

### Event-Specific Schemas
- `specifications/schemas/events/creation.schema.json` - ObjectEvent + commissioning + ilmd (manufacturing)
- `specifications/schemas/events/commission.schema.json` - ObjectEvent + commissioning (ID assignment)
- `specifications/schemas/events/sale.schema.json` - TransactionEvent + retail_selling (first sale)
- `specifications/schemas/events/repair.schema.json` - TransformationEvent + repairing (MRO)
- `specifications/schemas/events/resale.schema.json` - TransactionEvent + retail_selling + CPO (secondary)
- `specifications/schemas/events/decommission.schema.json` - ObjectEvent + decommissioning (end of life)

## Must-Haves

1. **event-base.schema.json** enforces required EPCIS 2.0 fields: @context, type, eventID, eventTime, eventTimeZoneOffset, action, bizStep, disposition
2. **All event schemas** use GS1 Digital Link URI format for epcList items: `https://id.gs1.org/01/{GTIN14}/21/{Serial}`
3. **eventID** follows RFC 6920 ni: URI format: `ni:///sha-256;{hash}?ver=CBV2.0`
4. **bizStep** values use CBV 2.0 URN format: `cbv:BizStep-{step}` (commissioning, retail_selling, repairing, decommissioning)
5. **disposition** values use CBV 2.0 URN format: `cbv:Disp-{state}` (active, retail_sold, destroyed)
6. **Creation/commission events** include ilmd section for immutable product attributes
7. **TransactionEvent schemas** include sourceList and destinationList with cbv:SDT-owning_party type
8. **TransformationEvent schema** supports same EPC in inputEPCList and outputEPCList (for repairs)
9. **All events** include readPoint for location tracking using SGLN URN format

## Approach

### Task 1: Event Base Schema

Create event-base.schema.json defining common EPCIS 2.0 structure:

**@context requirements:**
```json
{
  "@context": [
    "https://ref.gs1.org/standards/epcis/2.0.0/epcis-context.jsonld",
    "https://vocab.galileo.luxury/context/galileo.jsonld"
  ]
}
```

**Required fields (all events):**
- `type`: enum ["ObjectEvent", "TransactionEvent", "TransformationEvent"]
- `eventID`: pattern `^ni:///sha-256;[a-f0-9]{64}(\?ver=CBV2\.0)?$`
- `eventTime`: ISO 8601 datetime with timezone
- `eventTimeZoneOffset`: pattern `^[+-]\\d{2}:\\d{2}$`
- `action`: enum ["ADD", "OBSERVE", "DELETE"]
- `bizStep`: pattern `^cbv:BizStep-.+$`
- `disposition`: pattern `^cbv:Disp-.+$`
- `readPoint`: object with id (SGLN URN)

**Conditional fields:**
- `epcList`: required for ObjectEvent, TransactionEvent
- `inputEPCList`, `outputEPCList`: required for TransformationEvent
- `bizTransactionList`: optional for all
- `sourceList`, `destinationList`: required for TransactionEvent

**Galileo extensions namespace:**
- `galileo:dppContentHash`: SHA-256 hash of linked DPP document
- `galileo:productDID`: did:galileo reference

### Task 2: ObjectEvent Schemas (Creation, Commission, Decommission)

**creation.schema.json:**
- Extends event-base with type="ObjectEvent"
- action="ADD", bizStep="cbv:BizStep-commissioning", disposition="cbv:Disp-active"
- Required ilmd section:
  - `galileo:productionBatch`: string (batch identifier)
  - `galileo:artisanId`: did:galileo:artisan URI (pseudonymous)
  - `galileo:qualityGrade`: enum ["A+", "A", "B"]
  - `galileo:productDID`: did:galileo product reference
- Required: `galileo:dppContentHash` linking to DPP document

**commission.schema.json:**
- Extends event-base with type="ObjectEvent"
- action="ADD", bizStep="cbv:BizStep-commissioning", disposition="cbv:Disp-active"
- Required ilmd for ID assignment context:
  - `galileo:commissioningFacility`: facility DID
  - `galileo:nfcTagId`: optional NFC chip identifier
  - `galileo:qrCodeRef`: optional QR code reference
- Distinguishes from creation: commission is ID assignment, creation is manufacturing

**decommission.schema.json:**
- Extends event-base with type="ObjectEvent"
- action="DELETE", bizStep="cbv:BizStep-decommissioning"
- disposition: enum ["cbv:Disp-destroyed", "cbv:Disp-recalled", "cbv:Disp-stolen"]
- Required ilmd:
  - `galileo:decommissionReason`: enum [end_of_life_recycling, theft, loss, destruction, recall]
  - `galileo:recyclingPartner`: optional recycler DID
  - `galileo:materialsRecovered`: optional array (material, weight, disposition)

### Task 3: TransactionEvent Schemas (Sale, Resale)

**sale.schema.json (First Sale):**
- Extends event-base with type="TransactionEvent"
- action="ADD", bizStep="cbv:BizStep-retail_selling", disposition="cbv:Disp-retail_sold"
- Required bizTransactionList:
  - type: "cbv:BTT-po" (purchase order)
  - bizTransaction: invoice URN
- Required sourceList:
  - type: "cbv:SDT-owning_party"
  - source: brand DID (did:galileo:brand:xxx)
- Required destinationList:
  - type: "cbv:SDT-owning_party"
  - destination: anonymized customer hash (did:galileo:customer:anon-hash-xxx)
- Galileo extension:
  - `galileo:warrantyActivation`: startDate, duration (ISO 8601 duration), terms URL
  - `galileo:purchaseChannel`: enum [boutique, online, authorized_retailer]

**resale.schema.json:**
- Extends event-base with type="TransactionEvent"
- Same structure as sale.schema.json
- Additional required Galileo extension:
  - `galileo:resaleContext`:
    - channel: enum [certified_marketplace, auction, private_sale, brand_buyback]
    - marketplace: marketplace DID (optional)
    - authenticatedBy: authenticator DID
    - cpoStatus: enum [certified_pre_owned, authenticated, unverified]
    - condition: enum [new_with_tags, excellent, very_good, good, fair]
    - previousOwnerCount: integer >= 1

### Task 4: TransformationEvent Schema (Repair/MRO)

**repair.schema.json:**
- Extends event-base with type="TransformationEvent"
- bizStep="cbv:BizStep-repairing", disposition="cbv:Disp-active"
- Note: No action field for TransformationEvent (per EPCIS 2.0)
- Required inputEPCList and outputEPCList (same EPC for non-destructive repair)
- Required ilmd:
  - `galileo:repairType`: enum [leather_reconditioning, hardware_replacement, movement_service, glass_replacement, strap_replacement, full_restoration]
  - `galileo:repairDescription`: free text description
  - `galileo:technicianId`: did:galileo:technician (pseudonymous)
  - `galileo:partsReplaced`: array (partType, partNumber, origin)
  - `galileo:serviceOrderRef`: service order identifier
- Galileo extension:
  - `galileo:serviceHistory`:
    - serviceNumber: integer (nth service)
    - previousServices: array of prior event IDs
    - warrantyStatus: enum [in_warranty, out_of_warranty, extended_warranty]

## Dependencies

### External Standards
- **EPCIS 2.0**: https://ref.gs1.org/standards/epcis/2.0.0/ - Event structure and JSON-LD context
- **CBV 2.0**: https://ref.gs1.org/cbv/ - bizStep, disposition, source/destination types
- **RFC 6920**: ni: URI format for eventID hashing
- **GS1 Digital Link 1.4.0**: EPC URI format for product identifiers

### Prior Phase Outputs
- **Phase 2 (02-01-PLAN)**: GDPR-compliant data boundaries - customer identifiers must be anonymized hashes
- **Phase 2 (02-03-PLAN)**: did:galileo method - product and participant DIDs must follow this format

## Out of Scope

- DPP schema definition (covered in 03-01-PLAN)
- CBV vocabulary mapping documentation (covered in 03-03-PLAN)
- GS1 Digital Link resolver integration (covered in 03-03-PLAN)
- Molecular signature extension for events (covered in 03-03-PLAN)
- Event validation implementation code (specification only)
- Event storage infrastructure (operational concern)
- Event ordering and conflict resolution (Phase 7 infrastructure topic)

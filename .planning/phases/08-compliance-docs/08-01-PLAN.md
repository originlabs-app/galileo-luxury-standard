---
phase: 08-compliance-docs
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - specifications/compliance/guides/gdpr-compliance.md
  - specifications/compliance/guides/mica-compliance.md
  - specifications/compliance/guides/espr-readiness.md
autonomous: true

must_haves:
  truths:
    - "Adopter can implement GDPR right-to-erasure using CRAB model"
    - "Adopter can map Galileo specification to MiCA CASP requirements"
    - "Adopter can prepare for ESPR DPP 2027 mandatory compliance"
  artifacts:
    - path: "specifications/compliance/guides/gdpr-compliance.md"
      provides: "GDPR implementation guide with CRAB model erasure workflow"
      min_lines: 200
      contains: "CRAB"
    - path: "specifications/compliance/guides/mica-compliance.md"
      provides: "MiCA/CASP compliance mapping with Travel Rule implementation"
      min_lines: 200
      contains: "Travel Rule"
    - path: "specifications/compliance/guides/espr-readiness.md"
      provides: "ESPR/DPP readiness checklist for 2027 textile deadline"
      min_lines: 150
      contains: "2027"
  key_links:
    - from: "specifications/compliance/guides/gdpr-compliance.md"
      to: "specifications/architecture/HYBRID-ARCHITECTURE.md"
      via: "CRAB model reference"
      pattern: "HYBRID-ARCHITECTURE"
    - from: "specifications/compliance/guides/mica-compliance.md"
      to: "specifications/compliance/kyc-hooks.md"
      via: "Travel Rule implementation reference"
      pattern: "kyc-hooks"
    - from: "specifications/compliance/guides/espr-readiness.md"
      to: "specifications/schemas/dpp/dpp-core.schema.json"
      via: "DPP schema validation reference"
      pattern: "dpp-core.schema"
---

<objective>
Create comprehensive compliance guides enabling Galileo adopters to achieve GDPR, MiCA, and ESPR regulatory compliance.

Purpose: Translate technical specifications into actionable implementation guides with checklists, code examples, and regulatory deadline tracking. Guides reference existing specifications (HYBRID-ARCHITECTURE.md, kyc-hooks.md, dpp-core.schema.json) rather than duplicating content.

Output: Three compliance guides in specifications/compliance/guides/ directory
</objective>

<execution_context>
@/Users/pierrebeunardeau/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pierrebeunardeau/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-compliance-docs/08-RESEARCH.md

# Existing specifications to reference (DO NOT duplicate, LINK to these)
@specifications/architecture/HYBRID-ARCHITECTURE.md
@specifications/compliance/kyc-hooks.md
@specifications/compliance/aml-screening.md
@specifications/infrastructure/data-retention.md
@specifications/resolver/digital-link-uri.md
@specifications/schemas/dpp/dpp-core.schema.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: GDPR Compliance Guide</name>
  <files>specifications/compliance/guides/gdpr-compliance.md</files>
  <action>
Create GDPR implementation guide with the following structure:

## 1. Overview
- Purpose: Enable adopters to implement GDPR-compliant data processing in Galileo
- Key regulation: EDPB Guidelines 02/2025 for blockchain GDPR compliance
- Core pattern: CRAB (Content Reference with Anchored Binding) model

## 2. Data Classification Guide
Table mapping data types to storage locations:
- On-chain: Ownership hashes, attestation signatures, event anchors (NO PII)
- Off-chain: All personal data, encrypted content, customer records
Reference: HYBRID-ARCHITECTURE.md Section 2 (On-Chain vs Off-Chain Separation)

## 3. Right to Erasure Implementation (Article 17)
Step-by-step CRAB model workflow:
1. Receive and validate erasure request
2. Inventory all data for subject (on-chain references + off-chain content)
3. Check retention obligations (GDPR-AML conflict resolution per data-retention.md Section 4)
4. Execute erasure: delete off-chain content + destroy encryption keys
5. Result: on-chain hash becomes orphaned (points to nothing)
6. Log audit trail (non-PII metadata only)

Include TypeScript code example from 08-RESEARCH.md (processErasureRequest function)

## 4. GDPR-AML Conflict Resolution
Decision matrix for competing obligations:
- AML data: Retain 5 years minimum despite erasure request (5AMLD Art. 40)
- Transaction records: Retain 7 years (SOX compliance)
- Legal basis: GDPR Article 17(3)(b) exception for legal obligations
Reference: data-retention.md Section 4

## 5. Implementation Checklist
Structured checklist format with:
- [ ] Data classification mapping complete
- [ ] Off-chain storage configured for all PII
- [ ] CRAB encryption keys managed securely
- [ ] Erasure workflow implemented with 30-day SLA
- [ ] Retention obligation checks integrated
- [ ] Audit trail logging configured
- [ ] DPIA completed for blockchain processing

Each item includes: Requirement, Regulation citation, Verification method, Evidence required, Galileo component reference

## 6. Common Pitfalls
From research:
- Pitfall 1: Treating encrypted/hashed PII as non-personal data
- Pitfall 2: Assuming technical impossibility exempts blockchain
- Pitfall 5: Ignoring AML retention when processing erasure

## 7. Regulatory References
- EDPB Guidelines 02/2025: https://www.edpb.europa.eu/system/files/2025-04/edpb_guidelines_202502_blockchain_en.pdf
- GDPR Articles 12, 17, 17(3)(b)
- Galileo specifications: HYBRID-ARCHITECTURE.md, data-retention.md
  </action>
  <verify>
- File exists at specifications/compliance/guides/gdpr-compliance.md
- Contains "CRAB" model documentation
- References HYBRID-ARCHITECTURE.md
- Includes implementation checklist with checkboxes
- Contains code example for erasure workflow
- Minimum 200 lines
  </verify>
  <done>GDPR guide enables adopters to implement right-to-erasure in hybrid architecture using CRAB model with clear checklist and code examples</done>
</task>

<task type="auto">
  <name>Task 2: MiCA Compliance Guide</name>
  <files>specifications/compliance/guides/mica-compliance.md</files>
  <action>
Create MiCA/CASP compliance guide with the following structure:

## 1. Overview
- Purpose: Map Galileo specification to MiCA CASP authorization requirements
- Key deadline: July 1, 2026 (EU-wide CASP authorization mandatory)
- Key regulation: MiCA 2023/1114, TFR 2023/1113 (Travel Rule)

## 2. CASP Authorization Requirements
Table mapping MiCA requirements to Galileo components:

| CASP Requirement | Galileo Component | Implementation |
|------------------|-------------------|----------------|
| Identity verification | IGalileoIdentityRegistry | ONCHAINID claims from trusted issuers |
| Travel Rule data | kyc-hooks.md Section 9 | KYC claims contain originator/beneficiary |
| AML screening | aml-screening.md | Chainalysis Oracle + off-chain API |
| Transaction records | audit-trail.md | 7-year retention |
| Capital requirements | N/A (business requirement) | EUR 50k-150k depending on service |

## 3. Travel Rule Implementation (TFR 2023/1113)
Critical: NO de minimis threshold for CASP-to-CASP transfers

Step-by-step implementation:
1. Retrieve originator identity from IGalileoIdentityRegistry
2. Get KYC claim data (off-chain, referenced by hash)
3. Assemble TravelRuleData structure (originator name, account, address, ID, DOB)
4. Retrieve beneficiary identity similarly
5. Transmit data to counterparty CASP before or concurrent with transfer

Include TypeScript code example from 08-RESEARCH.md (getTravelRuleDataFromClaims function)

Reference: kyc-hooks.md Section 9 (Travel Rule Compliance)

## 4. Self-Hosted Wallet Verification
For transfers >EUR 1,000 involving self-custody addresses:
- Additional verification required per TFR Article 14
- Link to IGalileoIdentityRegistry.verifyIdentity() for wallet ownership proof

## 5. Jurisdiction-Specific Timeline Matrix

| Jurisdiction | Transitional Deadline | NCA | Notes |
|--------------|----------------------|-----|-------|
| Netherlands | July 2025 | AFM/DNB | Early adopter |
| Italy | December 2025 | CONSOB | Extended transition |
| Germany | July 2026 | BaFin | Standard MiCA |
| France | July 2026 | AMF | Standard MiCA |
| Spain | July 2026 | CNMV | Standard MiCA |
| Other EU | July 2026 | Local NCA | Check local guidance |

Advisory: Recommend early authorization regardless of local deadline

## 6. Implementation Checklist
- [ ] Identity Registry deployed with trusted KYC issuers
- [ ] KYC claims include Travel Rule required fields
- [ ] AML screening integration active (Chainalysis + supplementary)
- [ ] Transaction records retained for 5+ years
- [ ] Self-hosted wallet verification flow implemented
- [ ] Jurisdiction rules configured per jurisdiction-rules.md

Each item includes regulation citation and Galileo component reference

## 7. Common Pitfalls
From research:
- Pitfall 3: Missing Travel Rule threshold nuances (NO threshold for CASP-to-CASP)
- Pitfall 6: Misunderstanding MiCA authorization deadline variations

## 8. Regulatory References
- MiCA 2023/1114: https://eur-lex.europa.eu/eli/reg/2023/1114/oj
- TFR 2023/1113: https://eur-lex.europa.eu/eli/reg/2023/1113/oj
- Galileo specifications: kyc-hooks.md, aml-screening.md, jurisdiction-rules.md
  </action>
  <verify>
- File exists at specifications/compliance/guides/mica-compliance.md
- Contains "Travel Rule" documentation
- References kyc-hooks.md
- Includes jurisdiction timeline matrix
- Contains CASP requirement mapping table
- Minimum 200 lines
  </verify>
  <done>MiCA guide maps Galileo specification to CASP requirements and Travel Rule compliance with June 2026 deadline tracking</done>
</task>

<task type="auto">
  <name>Task 3: ESPR/DPP Readiness Guide</name>
  <files>specifications/compliance/guides/espr-readiness.md</files>
  <action>
Create ESPR/DPP readiness guide with the following structure:

## 1. Overview
- Purpose: Prepare adopters for ESPR Digital Product Passport mandatory compliance
- Key deadline: 2027 (textiles), 2030 (advanced), 2033 (full circular)
- Key regulation: ESPR 2024/1781

## 2. DPP Timeline for Luxury Goods

| Year | Requirement | Scope | Galileo Readiness |
|------|-------------|-------|-------------------|
| 2027 | Minimal DPP | Textiles/apparel | READY - dpp-core.schema.json |
| 2030 | Advanced DPP | Extended categories | READY - product schemas |
| 2033 | Full Circular DPP | All products | Pending delegated acts |

Note: Luxury goods (leather, watches, jewelry) delegated acts pending - monitor Commission

## 3. Mandatory Fields Checklist (ESPR 2024/1781)
Field-by-field mapping to dpp-core.schema.json:

| ESPR Requirement | Schema Field | Status | Validation |
|------------------|--------------|--------|------------|
| Material composition | materialComposition[] | COMPLIANT | Sum = 100% |
| Carbon footprint | carbonFootprint | COMPLIANT | ISO 14067 |
| Country of origin | countryOfOrigin | COMPLIANT | ISO 3166-1 |
| Repair instructions | repairInstructions | COMPLIANT | URL or text |
| Compliance declaration | complianceDeclaration | COMPLIANT | Boolean + cert |
| Unique identifier | @id (DID) + identifier | COMPLIANT | GTIN-14 |
| Manufacturer info | manufacturer | COMPLIANT | DID reference |
| Production date | productionDate | COMPLIANT | ISO 8601 |

Assessment: dpp-core.schema.json is ESPR 2024/1781 COMPLIANT for mandatory fields

## 4. Data Carrier Requirements
Per ISO 15459 and GS1 Digital Link 1.6.0:

### QR Code
- Minimum size: 10mm x 10mm
- Error correction: Level M minimum
- Content: GS1 Digital Link URI
- Format: https://id.galileo.luxury/01/{GTIN}/21/{Serial}

### NFC
- Standard: ISO 14443 Type A/B or ISO 15693
- NDEF record with GS1 Digital Link URI
- Write-protect after programming

Reference: digital-link-uri.md Section 3 (URI Syntax)

## 5. GS1 Integration
Linking GTIN to Galileo DID:

1. Product receives GTIN-14 from GS1
2. Galileo creates DID: did:galileo:01:{GTIN}:21:{serial}
3. QR/NFC encodes: https://id.galileo.luxury/01/{GTIN}/21/{serial}
4. Resolver returns DPP JSON-LD via content negotiation

Reference: digital-link-uri.md, resolver specification

## 6. DPP Validation
Include TypeScript validation example from 08-RESEARCH.md (validateDPPForESPR function)

Usage:
```typescript
import { validateDPPForESPR } from './dpp-validator';
const result = validateDPPForESPR(myDPP);
if (!result.espr2024Compliant) {
  console.log('Missing fields:', result.missingMandatory);
}
```

## 7. Implementation Checklist
- [ ] Product catalog mapped to GTIN-14 identifiers
- [ ] DPP schema validated against dpp-core.schema.json
- [ ] Material composition percentages sum to 100%
- [ ] Carbon footprint calculated per ISO 14067
- [ ] Repair instructions documented (URL or inline)
- [ ] QR codes generated per GS1 Digital Link specification
- [ ] NFC chips programmed (if applicable)
- [ ] Resolver endpoint configured for content negotiation
- [ ] Multi-language support for 24 EU languages (public data)

## 8. Product-Specific Schemas
Galileo provides validated schemas for luxury categories:
- dpp-textile.schema.json - Apparel and fabrics
- dpp-leather.schema.json - Leather goods
- dpp-watch.schema.json - Watches and jewelry

## 9. Common Pitfalls
From research:
- Pitfall 4: DPP confusion between product types and serial numbers (DPP is per INSTANCE)

## 10. Regulatory References
- ESPR 2024/1781: https://eur-lex.europa.eu/eli/reg/2024/1781/oj/eng
- GS1 Digital Link 1.6.0: https://www.gs1.org/standards/gs1-digital-link
- Galileo specifications: dpp-core.schema.json, digital-link-uri.md
  </action>
  <verify>
- File exists at specifications/compliance/guides/espr-readiness.md
- Contains "2027" deadline reference
- References dpp-core.schema.json
- Includes mandatory fields mapping table
- Contains data carrier requirements (QR, NFC)
- Minimum 150 lines
  </verify>
  <done>ESPR guide provides DPP readiness checklist for 2027 mandatory compliance with field mapping and validation examples</done>
</task>

</tasks>

<verification>
Phase verification checks:
1. All three guides exist in specifications/compliance/guides/
2. Each guide follows consistent structure (Overview, Implementation, Checklist, Pitfalls, References)
3. Guides reference existing specifications rather than duplicating content
4. Checklists use structured format with regulation citations
5. Code examples are TypeScript and reference actual interfaces
6. Regulatory deadlines are clearly documented
</verification>

<success_criteria>
1. GDPR guide enables adopters to implement right-to-erasure in hybrid architecture (CRAB model) with clear 7-section structure and implementation checklist
2. MiCA guide maps specification to CASP requirements and Travel Rule compliance with jurisdiction timeline matrix covering June 2026 deadline
3. ESPR guide provides DPP readiness checklist for 2027 mandatory compliance with field-by-field validation
4. All guides reference (not duplicate) existing Galileo specifications
5. All guides include actionable checklists with regulation citations
</success_criteria>

<output>
After completion, create `.planning/phases/08-compliance-docs/08-01-SUMMARY.md`
</output>

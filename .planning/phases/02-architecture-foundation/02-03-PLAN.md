---
phase: 02-architecture-foundation
plan: 03
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - specifications/identity/DID-METHOD.md
  - specifications/identity/DID-DOCUMENT.md
autonomous: true

must_haves:
  truths:
    - "Product DID syntax incorporates GS1 identifiers (GTIN + serial)"
    - "DID document contains service endpoints pointing to off-chain DPP storage"
    - "Resolution protocol returns proper DID resolution result per W3C spec"
    - "Product lifecycle (create, update, deactivate) is fully specified"
  artifacts:
    - path: "specifications/identity/DID-METHOD.md"
      provides: "did:galileo method specification"
      contains: "did:galileo"
    - path: "specifications/identity/DID-METHOD.md"
      provides: "Resolution protocol"
      contains: "DIDResolutionResult"
    - path: "specifications/identity/DID-DOCUMENT.md"
      provides: "DID document schema"
      contains: "verificationMethod"
    - path: "specifications/identity/DID-DOCUMENT.md"
      provides: "Service endpoint types"
      contains: "DigitalProductPassport"
  key_links:
    - from: "specifications/identity/DID-METHOD.md"
      to: "W3C DID Core v1.0"
      via: "specification reference"
      pattern: "W3C.*DID.*v1\\.0"
    - from: "specifications/identity/DID-DOCUMENT.md"
      to: "specifications/architecture/HYBRID-ARCHITECTURE.md"
      via: "service endpoint to off-chain storage"
      pattern: "serviceEndpoint.*resolver"
---

<objective>
Create the W3C DID-based product identity specification for luxury products.

Purpose: Define the `did:galileo` method for decentralized, non-revocable product identifiers that integrate with GS1 standards and point to off-chain DPP storage. This enables products to have persistent digital identities independent of any central authority (FOUND-02).

Output: Two specification files - `DID-METHOD.md` (method syntax and resolution) and `DID-DOCUMENT.md` (document schema and lifecycle).
</objective>

<execution_context>
@/Users/pierrebeunardeau/.claude/get-shit-done/workflows/execute-plan.md
@/Users/pierrebeunardeau/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-architecture-foundation/02-RESEARCH.md
@.planning/phases/02-architecture-foundation/02-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create did:galileo Method Specification</name>
  <files>specifications/identity/DID-METHOD.md</files>
  <action>
Create `specifications/identity/` directory.

Create `specifications/identity/DID-METHOD.md` with the following sections:

## 1. Overview

### 1.1 Purpose
Define the `did:galileo` DID method for identifying luxury products, brands, and participants within the Galileo Luxury Standard ecosystem.

### 1.2 Conformance
This specification conforms to W3C DID Core v1.0 (July 2022 Recommendation).

**Note:** W3C DID v1.1 is experimental. This specification intentionally targets v1.0 only.

### 1.3 Design Goals
- Incorporate GS1 identifiers (GTIN, serial) for physical product mapping
- Enable resolution via both blockchain registry and GS1 Digital Link
- Support brand, retailer, and participant identities alongside products
- Non-revocable identifiers (products exist forever, even if decommissioned)

## 2. Method Syntax

### 2.1 Method Name
```
method-name = "galileo"
```

### 2.2 Method-Specific Identifier

```
did-galileo = "did:galileo:" galileo-specific-id

galileo-specific-id = product-id / entity-id

product-id = application-identifier ":" identifier-value ":" serial-value

entity-id = entity-type ":" entity-name

application-identifier = "01" / "8006" / "8010" / "253"
    ; 01 = GTIN-13/GTIN-14
    ; 8006 = ITIP (piece of trade item)
    ; 8010 = CPID (coupon identification)
    ; 253 = GDTI (document type identifier)

identifier-value = 1*DIGIT
    ; GTIN: 13-14 digits
    ; Other AIs: variable per GS1 spec

serial-value = "21:" *ALPHANUM
    ; AI 21 = Serial number
    ; Optional but recommended for uniqueness

entity-type = "brand" / "retailer" / "issuer" / "artisan"

entity-name = 1*ALPHANUM
```

### 2.3 Examples

**Products (with GS1 identifiers):**
```
did:galileo:01:09506000134352:21:ABC123
    ; GTIN 09506000134352, Serial ABC123

did:galileo:01:09506000134352
    ; GTIN only (model-level, not unique item)

did:galileo:8006:095060001343521:21:LOT001-001
    ; ITIP for trade item piece
```

**Entities:**
```
did:galileo:brand:hermesparis
did:galileo:retailer:24sevres
did:galileo:issuer:verisart
did:galileo:artisan:pierresmith
```

### 2.4 ABNF Grammar

```abnf
did-galileo        = "did:galileo:" galileo-specific-id
galileo-specific-id = product-id / entity-id
product-id         = ai ":" ai-value *(":" "21:" serial)
ai                 = "01" / "8006" / "8010" / "253"
ai-value           = 8*14DIGIT
serial             = 1*35(ALPHA / DIGIT / "-" / ".")
entity-id          = entity-type ":" entity-name
entity-type        = "brand" / "retailer" / "issuer" / "artisan"
entity-name        = 1*64(ALPHA / DIGIT / "-")
```

## 3. DID Document Operations

### 3.1 Create

**Process:**
1. Brand registers product in on-chain Product Registry
2. Registry assigns product DID based on GTIN + serial
3. Initial DID document created with brand as controller
4. Off-chain DPP content linked via service endpoint

**On-Chain Record:**
```solidity
struct ProductRecord {
    bytes32 didHash;          // keccak256 of DID string
    address controller;       // Brand's identity address
    bytes32 contentHash;      // SHA-256 of off-chain DID document
    uint256 createdAt;        // Block timestamp
    uint256 updatedAt;        // Last modification
    bool active;              // false = decommissioned
}
```

**Events:**
```solidity
event ProductCreated(
    string indexed did,
    address indexed controller,
    bytes32 contentHash,
    uint256 timestamp
);
```

### 3.2 Read (Resolve)

See Section 4 (Resolution Protocol).

### 3.3 Update

**Allowed Updates:**
- Verification methods (key rotation)
- Service endpoints (new services)
- Controller (ownership transfer)
- DID document metadata

**Prohibited Updates:**
- DID identifier itself (immutable)
- Creation timestamp
- Historical event references

**On-Chain Event:**
```solidity
event ProductUpdated(
    string indexed did,
    bytes32 previousHash,
    bytes32 newHash,
    uint256 timestamp
);
```

### 3.4 Deactivate

Products are never truly deleted (provenance must persist), but can be deactivated:

**Process:**
1. Controller calls deactivate function
2. `active` set to false
3. DID document `deactivated` metadata set to true
4. Historical resolution still works

**On-Chain Event:**
```solidity
event ProductDeactivated(
    string indexed did,
    string reason,   // e.g., "destroyed", "lost", "recalled"
    uint256 timestamp
);
```

## 4. Resolution Protocol

### 4.1 Resolution Architecture

```
DID Resolution Flow:

[Client] --resolve--> [did:galileo Resolver]
                            |
            +---------------+---------------+
            |                               |
            v                               v
    [On-Chain Registry]             [Off-Chain Store]
    (ProductRecord)                 (Full DID Document)
            |                               |
            +---------------+---------------+
                            |
                            v
                    [DIDResolutionResult]
```

### 4.2 Resolution Endpoints

**Primary (HTTPS):**
```
GET https://resolver.galileo.luxury/1.0/identifiers/{did}
```

**GS1 Digital Link (for products):**
```
GET https://id.galileo.luxury/01/{gtin}/21/{serial}?linkType=gs1:did
```

### 4.3 Resolution Result

Per W3C DID Core v1.0:

```typescript
interface DIDResolutionResult {
  /**
   * The resolved DID document, or null if not found.
   */
  didDocument: DIDDocument | null;

  /**
   * Metadata about the resolution process itself.
   */
  didResolutionMetadata: {
    contentType?: string;           // "application/did+json"
    error?: ResolutionError;
    retrieved?: string;             // ISO timestamp
  };

  /**
   * Metadata about the DID document.
   */
  didDocumentMetadata: {
    created?: string;               // ISO timestamp
    updated?: string;               // ISO timestamp
    deactivated?: boolean;
    versionId?: string;             // Content hash
    nextVersionId?: string;         // If update pending
    nextUpdate?: string;            // Scheduled update time
  };
}

type ResolutionError =
  | "invalidDid"           // DID syntax invalid
  | "notFound"             // DID not in registry
  | "representationNotSupported"  // Requested format unavailable
  | "deactivated"          // Product decommissioned
  | "methodNotSupported";  // Not a did:galileo
```

### 4.4 Content Negotiation

| Accept Header | Response Type |
|---------------|---------------|
| `application/did+json` | JSON DID document (default) |
| `application/did+ld+json` | JSON-LD DID document |
| `application/did+cbor` | CBOR-encoded (compact) |

### 4.5 Resolution Algorithm

```typescript
async function resolveGalileoDID(did: string): Promise<DIDResolutionResult> {
  // 1. Parse DID
  const parsed = parseGalileoDID(did);
  if (!parsed) {
    return {
      didDocument: null,
      didResolutionMetadata: { error: "invalidDid" },
      didDocumentMetadata: {}
    };
  }

  // 2. Query on-chain registry
  const didHash = keccak256(did);
  const record = await productRegistry.getRecord(didHash);

  if (!record || record.createdAt === 0) {
    return {
      didDocument: null,
      didResolutionMetadata: { error: "notFound" },
      didDocumentMetadata: {}
    };
  }

  // 3. Check deactivation
  if (!record.active) {
    // Still return document, but flag as deactivated
    const doc = await fetchOffChainDocument(record.contentHash);
    return {
      didDocument: doc,
      didResolutionMetadata: { error: "deactivated" },
      didDocumentMetadata: {
        created: toISO(record.createdAt),
        updated: toISO(record.updatedAt),
        deactivated: true,
        versionId: record.contentHash
      }
    };
  }

  // 4. Fetch off-chain document
  const doc = await fetchOffChainDocument(record.contentHash);

  // 5. Verify integrity
  const computedHash = sha256(canonicalize(doc));
  if (computedHash !== record.contentHash) {
    // Integrity failure - log and investigate
    await logIntegrityFailure(did, record.contentHash, computedHash);
  }

  // 6. Return result
  return {
    didDocument: doc,
    didResolutionMetadata: {
      contentType: "application/did+json",
      retrieved: new Date().toISOString()
    },
    didDocumentMetadata: {
      created: toISO(record.createdAt),
      updated: toISO(record.updatedAt),
      versionId: record.contentHash
    }
  };
}
```

## 5. Security Considerations

### 5.1 DID Uniqueness
- GTIN + Serial combination guarantees uniqueness per GS1
- On-chain registry enforces uniqueness via didHash check
- Collision-resistant: keccak256 hash of DID string

### 5.2 Controller Authorization
- Only controller address can update/deactivate
- Controller transfer requires multi-sig or governance approval
- Brand identity must be verified before initial registration

### 5.3 Replay Protection
- All updates include nonce from on-chain state
- Timestamp bounds prevent replay of old updates
- Signature includes chain ID for cross-chain protection

### 5.4 Privacy Considerations
- DID itself contains no personal data (only product identifiers)
- Controller address is pseudonymous (not personal identity)
- All PII in off-chain DID document content (erasable per GDPR)
  </action>
  <verify>
File exists at `specifications/identity/DID-METHOD.md`.
File contains "did:galileo" method name.
File contains ABNF grammar for DID syntax.
File contains DIDResolutionResult interface.
File contains resolution algorithm.
File contains GS1 application identifier references (01, 8006, 8010, 253).
  </verify>
  <done>
did:galileo method specification complete with GS1 integration, CRUD operations, and W3C-compliant resolution protocol.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create DID Document Schema and Lifecycle</name>
  <files>specifications/identity/DID-DOCUMENT.md</files>
  <action>
Create `specifications/identity/DID-DOCUMENT.md` with the following sections:

## 1. Overview

### 1.1 Purpose
Define the DID document structure for Galileo products and entities, including verification methods, service endpoints, and lifecycle states.

### 1.2 Conformance
Per W3C DID Core v1.0, a DID document is a set of data describing the DID subject, including mechanisms to authenticate and authorize interactions.

## 2. Core Properties

### 2.1 Required Properties

```json
{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1",
    "https://galileo.luxury/ns/v1"
  ],
  "id": "did:galileo:01:09506000134352:21:ABC123",
  "controller": "did:galileo:brand:hermesparis"
}
```

| Property | Type | Required | Description |
|----------|------|----------|-------------|
| `@context` | array | Yes | JSON-LD context, must include W3C DID v1 |
| `id` | string | Yes | The DID this document describes |
| `controller` | string/array | Yes | DID(s) authorized to make changes |

### 2.2 Optional Properties

| Property | Type | Description |
|----------|------|-------------|
| `verificationMethod` | array | Cryptographic keys for verification |
| `authentication` | array | Keys for authentication |
| `assertionMethod` | array | Keys for signing claims |
| `keyAgreement` | array | Keys for encryption |
| `capabilityDelegation` | array | Keys to delegate capabilities |
| `service` | array | Service endpoints |
| `alsoKnownAs` | array | Alternative identifiers |

## 3. Verification Methods

### 3.1 Key Types Supported

Per crypto-agility specification:

| Type | Usage | Status |
|------|-------|--------|
| `EcdsaSecp256k1VerificationKey2019` | Ethereum-native signatures | Current |
| `Ed25519VerificationKey2020` | High-performance signatures | Current |
| `JsonWebKey2020` | Generic JWK wrapper | Current |
| `Multikey` | Future PQC keys | Planned |

### 3.2 Verification Method Structure

```json
{
  "verificationMethod": [{
    "id": "did:galileo:01:09506000134352:21:ABC123#key-1",
    "type": "Ed25519VerificationKey2020",
    "controller": "did:galileo:brand:hermesparis",
    "publicKeyMultibase": "z6MkhaXgBZDvotDkL5257faiztiGiC2QtKLGpbnnEGta2doK"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#key-2",
    "type": "EcdsaSecp256k1VerificationKey2019",
    "controller": "did:galileo:brand:hermesparis",
    "publicKeyHex": "04a1b2c3d4e5f6..."
  }]
}
```

### 3.3 Key ID Convention

```
key-id = did "#" key-fragment

key-fragment = "key-" key-number
             / "auth-" key-number
             / "assert-" key-number
             / "encrypt-" key-number

key-number = 1*3DIGIT
```

**Examples:**
- `did:galileo:01:09506000134352:21:ABC123#key-1` (primary)
- `did:galileo:01:09506000134352:21:ABC123#auth-1` (authentication)
- `did:galileo:01:09506000134352:21:ABC123#encrypt-1` (key agreement)

## 4. Service Endpoints

### 4.1 Service Types

| Type | Purpose | Endpoint Pattern |
|------|---------|------------------|
| `DigitalProductPassport` | ESPR DPP access | `https://resolver.galileo.luxury/dpp/{gtin}/{serial}` |
| `TraceabilityService` | Lifecycle events | `https://resolver.galileo.luxury/trace/{gtin}/{serial}` |
| `AuthenticityVerification` | Verify authenticity | `https://resolver.galileo.luxury/verify/{gtin}/{serial}` |
| `LinkedDomains` | Brand website link | Brand's verified domain |
| `CredentialRegistry` | VC status list | Claim issuer endpoint |
| `OwnershipTransfer` | Initiate transfer | Transfer service endpoint |

### 4.2 Service Structure

```json
{
  "service": [{
    "id": "did:galileo:01:09506000134352:21:ABC123#dpp",
    "type": "DigitalProductPassport",
    "serviceEndpoint": "https://resolver.galileo.luxury/dpp/09506000134352/ABC123"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#trace",
    "type": "TraceabilityService",
    "serviceEndpoint": "https://resolver.galileo.luxury/trace/09506000134352/ABC123"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#verify",
    "type": "AuthenticityVerification",
    "serviceEndpoint": "https://resolver.galileo.luxury/verify/09506000134352/ABC123"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#brand",
    "type": "LinkedDomains",
    "serviceEndpoint": "https://www.hermes.com/products/ABC123"
  }]
}
```

### 4.3 Service Endpoint Security

All service endpoints MUST:
- Use HTTPS (TLS 1.3 minimum)
- Support CORS for browser access
- Return appropriate cache headers
- Authenticate for write operations

Service endpoints MAY:
- Require authentication for sensitive data
- Return different views based on requester role
- Rate limit requests

## 5. Complete DID Document Example

### 5.1 Product DID Document

```json
{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1",
    "https://w3id.org/security/suites/secp256k1-2019/v1",
    "https://galileo.luxury/ns/v1"
  ],
  "id": "did:galileo:01:09506000134352:21:ABC123",
  "controller": "did:galileo:brand:hermesparis",
  "alsoKnownAs": [
    "https://id.galileo.luxury/01/09506000134352/21/ABC123"
  ],
  "verificationMethod": [{
    "id": "did:galileo:01:09506000134352:21:ABC123#key-1",
    "type": "Ed25519VerificationKey2020",
    "controller": "did:galileo:brand:hermesparis",
    "publicKeyMultibase": "z6MkhaXgBZDvotDkL5257faiztiGiC2QtKLGpbnnEGta2doK"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#key-2",
    "type": "EcdsaSecp256k1VerificationKey2019",
    "controller": "did:galileo:brand:hermesparis",
    "publicKeyHex": "04a1b2c3d4e5f60708091011121314151617181920212223242526272829303132"
  }],
  "authentication": [
    "did:galileo:01:09506000134352:21:ABC123#key-1"
  ],
  "assertionMethod": [
    "did:galileo:01:09506000134352:21:ABC123#key-1",
    "did:galileo:01:09506000134352:21:ABC123#key-2"
  ],
  "service": [{
    "id": "did:galileo:01:09506000134352:21:ABC123#dpp",
    "type": "DigitalProductPassport",
    "serviceEndpoint": "https://resolver.galileo.luxury/dpp/09506000134352/ABC123"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#trace",
    "type": "TraceabilityService",
    "serviceEndpoint": "https://resolver.galileo.luxury/trace/09506000134352/ABC123"
  }, {
    "id": "did:galileo:01:09506000134352:21:ABC123#verify",
    "type": "AuthenticityVerification",
    "serviceEndpoint": "https://resolver.galileo.luxury/verify/09506000134352/ABC123"
  }]
}
```

### 5.2 Brand DID Document

```json
{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1",
    "https://galileo.luxury/ns/v1"
  ],
  "id": "did:galileo:brand:hermesparis",
  "controller": "did:galileo:brand:hermesparis",
  "verificationMethod": [{
    "id": "did:galileo:brand:hermesparis#key-1",
    "type": "Ed25519VerificationKey2020",
    "controller": "did:galileo:brand:hermesparis",
    "publicKeyMultibase": "z6MkpTHR8VNsBxYAAWHut2Geadd9jSwuBV8xRoAnwWsdvktH"
  }],
  "authentication": [
    "did:galileo:brand:hermesparis#key-1"
  ],
  "assertionMethod": [
    "did:galileo:brand:hermesparis#key-1"
  ],
  "service": [{
    "id": "did:galileo:brand:hermesparis#website",
    "type": "LinkedDomains",
    "serviceEndpoint": "https://www.hermes.com"
  }, {
    "id": "did:galileo:brand:hermesparis#products",
    "type": "ProductRegistry",
    "serviceEndpoint": "https://api.galileo.luxury/brands/hermesparis/products"
  }]
}
```

## 6. Lifecycle States

### 6.1 State Diagram

```
                    [Created]
                        |
            +-----------+-----------+
            |                       |
            v                       v
        [Active]              [Pending Transfer]
            |                       |
    +-------+-------+               |
    |       |       |               |
    v       v       v               v
[Updated] [Key    [Service      [Transferred]
           Rotated] Added]          |
    |       |       |               |
    +-------+-------+---------------+
            |
            v
      [Deactivated]
            |
            v
        (Terminal)
```

### 6.2 State Transitions

| From | To | Trigger | Authorization |
|------|-----|---------|---------------|
| - | Created | Product registration | Brand controller |
| Created | Active | First DPP content linked | Brand controller |
| Active | Updated | DPP content change | Controller |
| Active | Key Rotated | Key rotation | Controller |
| Active | Service Added | New service endpoint | Controller |
| Active | Pending Transfer | Transfer initiated | Controller |
| Pending Transfer | Transferred | Transfer accepted | New controller |
| Pending Transfer | Active | Transfer cancelled | Original controller |
| Any Active | Deactivated | Product decommissioned | Controller |
| Deactivated | - | (Terminal state) | - |

### 6.3 Deactivation Reasons

```typescript
enum DeactivationReason {
  DESTROYED = "destroyed",      // Physical product no longer exists
  LOST = "lost",                // Product location unknown
  RECALLED = "recalled",        // Product recalled by manufacturer
  COUNTERFEIT = "counterfeit",  // Identified as counterfeit
  MERGED = "merged",            // Merged with another product DID
  ERROR = "error"               // Created in error, never valid
}
```

## 7. Galileo JSON-LD Context

### 7.1 Context Definition

```json
{
  "@context": {
    "@version": 1.1,
    "galileo": "https://galileo.luxury/ns/v1#",
    "DigitalProductPassport": "galileo:DigitalProductPassport",
    "TraceabilityService": "galileo:TraceabilityService",
    "AuthenticityVerification": "galileo:AuthenticityVerification",
    "ProductRegistry": "galileo:ProductRegistry",
    "gtin": {
      "@id": "galileo:gtin",
      "@type": "xsd:string"
    },
    "serialNumber": {
      "@id": "galileo:serialNumber",
      "@type": "xsd:string"
    },
    "deactivationReason": {
      "@id": "galileo:deactivationReason",
      "@type": "@vocab"
    }
  }
}
```

### 7.2 Context URL

Published at: `https://galileo.luxury/ns/v1`

Implementations MUST fetch and cache this context.

## 8. Integration with Hybrid Architecture

### 8.1 On-Chain Storage

Per HYBRID-ARCHITECTURE.md, the on-chain registry stores:
- `didHash`: keccak256 of DID string
- `controller`: Ethereum address of controller
- `contentHash`: SHA-256 of full DID document
- Timestamps: `createdAt`, `updatedAt`
- `active`: boolean deactivation flag

### 8.2 Off-Chain Storage

The full DID document is stored off-chain because:
- Contains service endpoints (potentially with session tokens)
- May contain extended metadata
- Must be updateable without on-chain transaction for minor changes
- Content addressed via hash for integrity verification

### 8.3 Resolution Path

```
1. Client requests: did:galileo:01:09506000134352:21:ABC123
2. Resolver computes: keccak256("did:galileo:01:09506000134352:21:ABC123")
3. Resolver queries: ProductRegistry.getRecord(didHash)
4. Resolver fetches: Off-chain store by contentHash
5. Resolver verifies: SHA-256(document) === contentHash
6. Resolver returns: DIDResolutionResult
```

### 8.4 GDPR Compliance

DID documents for products contain NO personal data:
- Product identifiers (GTIN, serial) are not personal data
- Controller is a DID (pseudonymous identifier)
- Keys are cryptographic material, not personal data
- Service endpoints are public URLs

For entity DIDs (e.g., artisans), personal data is:
- Stored OFF-CHAIN only
- Linked via service endpoint (erasable)
- Never embedded in DID document
  </action>
  <verify>
File exists at `specifications/identity/DID-DOCUMENT.md`.
File contains verification method structure with Ed25519 and secp256k1.
File contains service endpoint types (DigitalProductPassport, TraceabilityService).
File contains complete product DID document example.
File contains lifecycle state diagram.
File contains integration with HYBRID-ARCHITECTURE.md reference.
  </verify>
  <done>
DID document schema defines verification methods, service endpoints, and lifecycle states. Complete examples for products and brands. Integration with hybrid architecture ensures GDPR compliance.
  </done>
</task>

</tasks>

<verification>
1. `specifications/identity/DID-METHOD.md` defines did:galileo syntax with GS1 integration
2. Resolution protocol returns W3C-compliant DIDResolutionResult
3. `specifications/identity/DID-DOCUMENT.md` defines verification methods and services
4. Service endpoints point to off-chain DPP storage
5. Lifecycle states cover create, update, transfer, deactivate
6. JSON-LD context defined for Galileo-specific types
7. Integration with hybrid architecture is explicit
</verification>

<success_criteria>
- FOUND-02 requirement satisfied: W3C DID-based product identity schema complete
- Any product can be identified via did:galileo with GS1 identifiers
- DID documents reference off-chain DPP storage via service endpoints
- Resolution protocol is W3C v1.0 compliant
- Lifecycle supports full product journey including decommission
</success_criteria>

<output>
After completion, create `.planning/phases/02-architecture-foundation/02-03-SUMMARY.md`
</output>
